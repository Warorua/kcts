/*! For license information please see 97.4cdbfa61.chunk.js.LICENSE.txt */
(this["webpackJsonpnrs-user-frontend"]=this["webpackJsonpnrs-user-frontend"]||[]).push([[97],{1448:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(89),i=n(42),l=n(34),c=n(0),s=n(18),u=n(815),d=n(620),b=n(233),m=n(235),p=n(692),v=n(633),f=n(88),h=n(37),g=n(81),y=n(762),_=n(638),O=function(e){var t=e.onChange,n=e.onSelectChange,o=e.setValues,l=e.values,s=e.onValidChange,u=e.error,d=e.useKra,m=(e.setUseKra,l.registered),p=l.brsNumber,O=l.kraPin,E=Object(a.useCallback)(s,[]),j=Object(f.useSelector)((function(e){return e})).profile,S=Object(f.useDispatch)(),C=Object(a.useCallback)(S,[]);Object(a.useEffect)((function(){void 0===m&&E(!1),!1===m&&E(!0),m&&E(d?!!O:!!p)}),[E,m,p,d,O]);var w=[{value:!0,label:"Already Registered",key:"new_business",id:"registered"},{value:!1,label:"Unregistered",key:"unregistered_business",id:"registered"}],x=Object(f.useSelector)((function(e){return{sbpRegisterList:e.singleBusinessPermit.sbpRegister.response}})).sbpRegisterList,N=null===x||void 0===x?void 0:x.map((function(e){return{value:e.sbp_no.toUpperCase(),label:e.sbp_name.toUpperCase(),id:"sbp_number"}}));Object(a.useEffect)((function(){if("0"!==l.application_type&&(Object(_.p)(C,{expired:!0}).then(),"3"!==l.applicationTypes)){localStorage.setItem("drafts",JSON.stringify(Object(c.a)(Object(c.a)({},JSON.parse(localStorage.getItem("drafts")||"{}")),{},{greyOut:!1})))}if("0"===l.application_type||"3"===l.application_type){localStorage.setItem("drafts",JSON.stringify(Object(c.a)(Object(c.a)({},JSON.parse(localStorage.getItem("drafts")||"{}")),{},{greyOut:!1})))}}),[null===l||void 0===l?void 0:l.application_type]);var P=w.find((function(e){return m===e.value}));return r.a.createElement(b.a,null,r.a.createElement(h.a,null,!j.activeUser.business_name&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",{style:{color:"red"}},"Disclaimer:"),r.a.createElement("h6",{style:{paddingBottom:16,color:"red"}},"This account is an individual Account. Any business permit applied will be tied to this individual. For corporate business licence please ensure that you log in using a corporate account")),r.a.createElement(v.a,{handleSelectChange:n,options:y.a||[],placeholder:"Application Type",label:"Application Type",labelId:"application_type",key:"application_type",isLoading:!1,required:!0,selectedValue:null===l||void 0===l?void 0:l.application_type,requiredError:"Please select application type"}),parseInt(null===l||void 0===l?void 0:l.application_type)?r.a.createElement(v.a,{handleSelectChange:function(e){var t=x.find((function(t){return t.sbp_no.toUpperCase()===e.value}));o((function(e){var n;return Object(c.a)(Object(c.a)(Object(c.a)({},e),t),{},(n={area_meters_square:null===t||void 0===t?void 0:t.premise_size,phone_number:null===t||void 0===t?void 0:t.phone_no,contact_person_id:null===t||void 0===t?void 0:t.Contactperson_id,contact_person_name:null===t||void 0===t?void 0:t.Contactperson_name,contact_person_email:null===t||void 0===t?void 0:t.contactperson_email,contact_person_phone:null===t||void 0===t?void 0:t.contactperson_phoneno,plot_bulding_name:null===t||void 0===t?void 0:t.building,addition_activity:null===t||void 0===t?void 0:t.additional_activity,sub_county_name:null===t||void 0===t?void 0:t.sub_county_name,ward_name:null===t||void 0===t?void 0:t.ward_name,business_category:null===t||void 0===t?void 0:t.buss_category,buss_sub_category:null===t||void 0===t?void 0:t.buss_sub_category,sub_category_name:null===t||void 0===t?void 0:t.sub_category_name,business_name:null===t||void 0===t?void 0:t.sbp_name,plot_no:null===t||void 0===t?void 0:t.plot_no},Object(i.a)(n,"plot_bulding_name",null===t||void 0===t?void 0:t.building),Object(i.a)(n,"floor_no",parseInt(null===t||void 0===t?void 0:t.floor)||0),Object(i.a)(n,"room_stall",null===t||void 0===t?void 0:t.room_stall),Object(i.a)(n,"pobox",null===t||void 0===t?void 0:t.pobox),Object(i.a)(n,"postal_code",null===t||void 0===t?void 0:t.postal_code),Object(i.a)(n,"buss_description",null===t||void 0===t?void 0:t.sbp_description),Object(i.a)(n,"address",null===t||void 0===t?void 0:t.street_house),Object(i.a)(n,"AdditionalActivity",null===t||void 0===t?void 0:t.AdditionalActivity),Object(i.a)(n,"sub_county",null===t||void 0===t?void 0:t.sub_county_code),Object(i.a)(n,"ward",null===t||void 0===t?void 0:t.ward_code),Object(i.a)(n,"subsidiaryname",null===t||void 0===t?void 0:t.subsidiaryname),Object(i.a)(n,"address",null===t||void 0===t?void 0:t.street_house),Object(i.a)(n,"buss_category_name",null===t||void 0===t?void 0:t.buss_category_name),Object(i.a)(n,"no_of_employees",null===t||void 0===t?void 0:t.no_of_employees),Object(i.a)(n,"tier_code",null===t||void 0===t?void 0:t.business_size),n))})),n(e)},options:N||[],placeholder:"Select previous application",label:"Select previous application",labelId:"sbp_no",key:"sbp_no",isLoading:!1,required:!0,selectedValue:null===l||void 0===l?void 0:l.sbp_no,requiredError:"Please select previous application"}):"0"===(null===l||void 0===l?void 0:l.application_type)&&r.a.createElement(v.a,{options:w,placeholder:"New business",onChange:n,label:"Is your business already registered before?",labelId:"registration_status",value:P,selectedValue:null===P||void 0===P?void 0:P.label,defaultValue:P,required:!0})),m&&r.a.createElement(h.a,null,r.a.createElement(g.a,{label:r.a.createElement("span",{style:{color:u.message&&"red"}},d?"KRA PIN":"Business Registration Certificate No."),type:"text",className:"form-control pl-5 m-0",onChange:t,name:d?"kraPin":"brsNumber",id:d?"kraPin":"brsNumber",value:d?O:p,placeholder:d?"e.g P001234567T":"e.g BN/2020/12345",helpText:r.a.createElement("div",{style:{color:"red",height:16}},(p||O)&&u.message&&u.message),style:{borderColor:u.message&&"red"},invalid:!0,validate:{required:{value:!0,errorMessage:"".concat(d?"KRA Pin":"Business Registration No."," is required")},pattern:{value:d?"^[A-Za-z]{1}[0-9]+[A-Za-z]{1}$":"^.+$",errorMessage:d?"Please Enter a valid kra Pin":"Please Enter a valid Business Registration Certificate No."}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,null,r.a.createElement("h5",null,"TERMS AND CONDITIONS"),r.a.createElement("p",null,"This licence is issued under section 12 of the Act subject to the following terms and conditions: -"),r.a.createElement("ol",{type:1},r.a.createElement("li",null,"Compliance with the provisions of the Nairobi City County Trade Licensing Act and subsidiary Legislation."),r.a.createElement("li",null,"The licence shall be valid for trade and areas specified in the licence."),r.a.createElement("li",null,"The licence holder must notify the Director of any changes in the nature of trade, directorship or ownership of the business, location of business or cessation of trade."),r.a.createElement("li",null,"The licence is a Nairobi City County Government property and must be displayed in a conspicuous place within the business premises and the licence holder must produce the licence whenever an authorized officer requires him or her."),r.a.createElement("li",null,"The licence shall apply to only one business or trade."),r.a.createElement("li",null,"A Permit can be cancelled or suspended if any of the conditions in the Nairobi City County Trade Licensing Act, 2019 is Contravened."),r.a.createElement("li",null,"Renewal of this Permit shall be done on Expiry Date to after 12 months from the date of payment."),r.a.createElement("li",null,"The owner of the business should notify director trade Licensing in writing once s/he closes the business and the License to be surrendered to the same office."),r.a.createElement("li",null,"The owner of the business should not sell/display their goods outside their licensed premises."),r.a.createElement("li",null,"A person who forges or alters a licence without authority commits an offence and shall be liable on conviction to a fine not exceeding Kenya shillings fifty thousand or to imprisonment for a term not exceeding three months, or both."),r.a.createElement("li",null,"A person who fails or neglects to renew a licence as required and continues to operate the business or trade commits an offence and shall be liable on conviction to a fine not exceeding Kenya shillings fifty thousand or to imprisonment for a term not exceeding three months, or both."),r.a.createElement("li",null,"Granting of this Trade License does not legitimise occupation of your space."))))},E=n(109),j=function(e){var t=e.onChange,n=e.values,a=JSON.parse(localStorage.getItem("drafts"));return a.greyOut=!1,r.a.createElement(E.a,{xs:1,sm:2},r.a.createElement(h.a,null,r.a.createElement(g.a,{required:!0,label:"Plot/LR No",type:"text",className:"form-control pl-5 m-0",name:"plot_no",value:null===n||void 0===n?void 0:n.plot_no,id:"plot_no",onChange:t,placeholder:"Enter plot number",disabled:null===a||void 0===a?void 0:a.greyOut,validate:{required:{value:!0,errorMessage:"Please enter plot number"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,null,r.a.createElement(g.a,{required:!0,label:"Building name",type:"text",className:"form-control pl-5 m-0",name:"plot_bulding_name",id:"plot_bulding_name",onChange:t,value:null===n||void 0===n?void 0:n.plot_bulding_name,placeholder:"Enter plot building name",disabled:null===a||void 0===a?void 0:a.greyOut,validate:{required:{value:!0,errorMessage:"Please enter plot building name"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,null,r.a.createElement(g.a,{label:"Floor number  (optional)",type:"text",className:"form-control pl-5 m-0",name:"floor_no",id:"floor_no",values:null===n||void 0===n?void 0:n.floor_no,onChange:t,placeholder:"Enter floor number",disabled:null===a||void 0===a?void 0:a.greyOut,validate:{required:{value:!0,errorMessage:"Please enter floor number"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,null,r.a.createElement(g.a,{label:"Room stall number (optional)",type:"text",className:"form-control pl-5 m-0",name:"room_stall",value:null===n||void 0===n?void 0:n.room_stall,id:"room_stall",onChange:t,placeholder:"Enter room stall number",disabled:null===a||void 0===a?void 0:a.greyOut,validate:{required:{value:!0,errorMessage:"Please enter room stall number"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))))},S=n(30),C=function(e){var t=e.values,n=e.onChange,o=e.onSelectChange,i=e.onValidChange,l=e.setValues,s=Object(a.useCallback)(i,[]),u=Object(f.useDispatch)(),d=JSON.parse(localStorage.getItem("drafts"));d.greyOut=!1;var b=Object(f.useSelector)((function(e){var t=e.singleBusinessPermit;return Object(c.a)({},t)})).businessDetails.response.records,m=void 0===b?[]:b,p=Object(f.useSelector)((function(e){return e.global.subCounties})),y=Object(f.useSelector)((function(e){return e.global.wards})),O=Object(S.h)().search,C=new URLSearchParams(O).get("brsNumber"),w=new URLSearchParams(O).get("kraPin");Object(a.useEffect)((function(){C&&(Object(_.k)({brs_no:(C||"").trim()},u,(function(){})),l((function(e){return Object(c.a)(Object(c.a)({},e),{},{brs_number:C})})))}),[u,C]),Object(a.useEffect)((function(){w&&(Object(_.k)({kra_pin:(w||"").trim()},u,(function(){})),l((function(e){return Object(c.a)(Object(c.a)({},e),{},{kra_pin:w})})))}),[u,C]),Object(a.useEffect)((function(){Object(_.i)("subcounties","",(function(e){u(Object(_.q)(e.subcountyres))}),console.error).then()}),[]),Object(a.useEffect)((function(){if(null===t||void 0===t?void 0:t.sub_county){Object(_.i)("wards","/".concat(null===t||void 0===t?void 0:t.sub_county),(function(e){u(Object(_.r)(e.wardres))}),console.error).then()}}),[]),Object(a.useEffect)((function(){var e=p.map((function(e){return e.description}));if(null===t||void 0===t?void 0:t.sub_county_name){var n=t.sub_county_name.toLowerCase();if(e.includes(n)){var a=p.find((function(e){return e.description===n}));l((function(e){return Object(c.a)(Object(c.a)({},e),{},{sub_county:a.code})}))}}}),[p]),Object(a.useEffect)((function(){var e=y.map((function(e){return e.description}));if(null===t||void 0===t?void 0:t.ward_name){var n=t.ward_name.toLowerCase();if(e.includes(n)){var a=y.find((function(e){return e.description===n}));l((function(e){return Object(c.a)(Object(c.a)({},e),{},{ward:a.code})}))}}}),[y]);var x=p.map((function(e){return{id:"sub_county",label:r.a.createElement("span",{style:{textTransform:"capitalize"}},e.description),key:e.code,value:e.code}})),N=y.map((function(e){return{id:"ward",label:r.a.createElement("span",{style:{textTransform:"capitalize"}},e.description),key:e.code,value:e.code}}));Object(a.useEffect)((function(){var e=t.business_name;s(!!e)}),[s,t]);m[0];return r.a.createElement("div",null,r.a.createElement(E.a,null,r.a.createElement(h.a,{xs:12},r.a.createElement(g.a,{label:"Enter business name",required:!0,type:"text",className:"form-control pl-5 m-0",name:"business_name",value:null===t||void 0===t?void 0:t.business_name,id:"business_name",onChange:n,placeholder:"Enter business name",disabled:null===d||void 0===d?void 0:d.greyOut,validate:{required:{value:!0,errorMessage:"Please enter business name"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,{xs:6},r.a.createElement(g.a,{label:"Enter subsidiary name(e.g Westlands Branch)",type:"text",className:"form-control pl-5 m-0",name:"subsidiary_name",value:null===t||void 0===t?void 0:t.subsidiary_name,disabled:null===d||void 0===d?void 0:d.greyOut,id:"subsidiary_name",onChange:n,placeholder:"Westlands branch"},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,{xs:6},r.a.createElement(g.a,{label:"Street/Estate Name",required:!t.registered,type:"text",className:"form-control pl-5 m-0",name:"address",id:"address",value:null===t||void 0===t?void 0:t.address,onChange:n,disabled:null===d||void 0===d?void 0:d.greyOut,placeholder:"e.g Nairobi CBD",validate:{required:{value:!0,errorMessage:"Please enter a physical address"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,{xs:6},r.a.createElement(v.a,{handleSelectChange:o,options:x,placeholder:(null===t||void 0===t?void 0:t.sub_county)||"Select Sub County",label:"Select Sub County",labelId:"sub_county",isLoading:!1,selectedValue:null===t||void 0===t?void 0:t.sub_county,requiredError:"Please select sub county",defaultValue:x.find((function(e){return(null===t||void 0===t?void 0:t.sub_county)===e.value})),value:x.find((function(e){return(null===t||void 0===t?void 0:t.sub_county)===e.value})),isDisabled:null===d||void 0===d?void 0:d.greyOut,required:!0})),r.a.createElement(h.a,{xs:6},r.a.createElement(v.a,{handleSelectChange:o,options:N,placeholder:(null===t||void 0===t?void 0:t.ward)||"Select Ward",label:"Select Ward",labelId:"ward",isLoading:!1,selectedValue:null===t||void 0===t?void 0:t.ward,requiredError:"Please select ward",defaultValue:N.find((function(e){return(null===t||void 0===t?void 0:t.ward)===e.value})),value:N.find((function(e){return(null===t||void 0===t?void 0:t.ward)===e.value})),isDisabled:null===d||void 0===d?void 0:d.greyOut,required:!0}))),r.a.createElement(j,{values:t,onChange:n}))},w=n(623),x=n(99),N=function(e){var t=e.values,n=e.onChange,o=e.onValidChange,i=e.setValues,l=e.onSelectChange,u=Object(a.useCallback)(o,[]),d=Object(a.useCallback)(i,[]),b=Object(f.useDispatch)();Object(a.useEffect)((function(){var e,n,a,r,o=t.contact_person_phone,i=t.contact_person_name,l=t.contact_person_email,c=null===t||void 0===t||null===(e=t.contact_person_name)||void 0===e||null===(n=e.toLowerCase())||void 0===n?void 0:n.split(/\s/g)[0],s=null===P||void 0===P||null===(a=P.full_name)||void 0===a||null===(r=a.toLowerCase())||void 0===r?void 0:r.split(/\s/g)[0];u(o&&i&&l&&c===s)}),[t,u]);var m=Object(f.useSelector)((function(e){return e.singleBusinessPermit.postalCodes})),p=Object(f.useSelector)((function(e){return e.singleBusinessPermit.businessLookups})),y=Object(a.useState)(!1),O=Object(s.a)(y,2),j=O[0],S=O[1];Object(a.useEffect)((function(){S(!0);Object(_.o)(b,(function(){S(!1)}),(function(){S(!1)})).then(),Object(_.l)(b).then()}),[b]);var C=Object(f.useSelector)((function(e){var t=e.singleBusinessPermit;return Object(c.a)({},t)})).businessDetails.response.records,N=((void 0===C?[]:C)[0],Object(f.useSelector)((function(e){return e.profile.activeUser}))),P=Object(f.useSelector)((function(e){return e.singleBusinessPermit.contactUser}));Object(a.useEffect)((function(){N.mobile_number&&d((function(e){return Object(c.a)(Object(c.a)({},e),{},{contact_person_phone:N.mobile_number})})),N.email&&d((function(e){return Object(c.a)(Object(c.a)({},e),{},{email:N.email})})),(N.id_number||N.passport_no||N.pin_no)&&d((function(e){return Object(c.a)(Object(c.a)({},e),{},{contact_person_id:void 0===e.contact_person_id?N.id_number||N.passport_no||N.pin_no:e.contact_person_id})}))}),[N,d]);var q=Object(a.useState)(!1),k=Object(s.a)(q,2),L=k[0],I=k[1],B=Object(a.useState)(""),A=Object(s.a)(B,2),R=A[0],V=A[1],z=m.map((function(e){return{id:"postal_code",label:"".concat(e.Town," - ").concat(e.Code),key:e.Code,town:e.Town,value:e.Code}})),T=p.map((function(e){return{id:"business_role",value:e.Code,label:e.Description,key:e.Code}}));return r.a.createElement(E.a,{style:{alignItems:"center"}},r.a.createElement(h.a,{style:{textAlign:"center"},xs:12},r.a.createElement(w.a,{color:"primary"},r.a.createElement("strong",null,"Business Contacts"))),r.a.createElement(h.a,{xs:6},r.a.createElement(g.a,{label:"Email",type:"email",className:"form-control pl-5 m-0",name:"email",value:null===t||void 0===t?void 0:t.email,id:"email",errorMessage:"Please enter a valid email address",onChange:n,placeholder:"Enter email address",validate:{required:{value:!0,errorMessage:"Please enter email address"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,{xs:6},r.a.createElement(g.a,{label:"Enter company phone number",required:!0,type:"text",className:"form-control pl-5 m-0",name:"phone_number",id:"phone_number",value:null===t||void 0===t?void 0:t.phone_number,onChange:n,placeholder:"Enter phone number",validate:{required:{value:!0,errorMessage:"Please enter phone number"},pattern:{value:x.d,errorMessage:x.e}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,{xs:6},r.a.createElement(g.a,{label:"Postal Address",type:"text",className:"form-control pl-5 m-0",name:"pobox",id:"pobox",value:null===t||void 0===t?void 0:t.pobox,onChange:n,placeholder:"Postal Address",validate:{required:{value:!0,errorMessage:"Please enter postal address"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,{xs:6},r.a.createElement(v.a,{handleSelectChange:function(e){var t=Object(c.a)(Object(c.a)({},e),{},{id:"town",value:e.town});l(e),l(t)},options:z,placeholder:"Select Postal Code",label:"Select Postal code",labelId:"postal_code",isLoading:j,selectedValue:null===t||void 0===t?void 0:t.postal_code,requiredError:"Please select postal code",defaultValue:z.find((function(e){return(null===t||void 0===t?void 0:t.postal_code)===e.value})),value:z.find((function(e){return(null===t||void 0===t?void 0:t.postal_code)===e.value})),required:!0})),r.a.createElement(h.a,{style:{textAlign:"center"},xs:12},r.a.createElement(w.a,{color:"primary"},r.a.createElement("strong",null,"Contact Person"))),r.a.createElement(h.a,{xs:6},r.a.createElement(g.a,{label:"National ID",required:!0,className:"form-control pl-5 m-0",name:"contact_person_id",id:"contact_person_id",onBlur:function(){return Object(_.j)(null===t||void 0===t?void 0:t.contact_person_id,b)},value:null===t||void 0===t?void 0:t.contact_person_id,onChange:function(e){I(!1),n(e),d((function(e){return Object(c.a)(Object(c.a)({},e),{},{contact_person_name:""})}))},placeholder:"Enter contact person Id",validate:{required:{value:!0,errorMessage:"Enter contact person Id"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,{xs:6},r.a.createElement(v.a,{handleSelectChange:l,options:T,placeholder:"Role of Contact Person in the Business",label:"Role in business",labelId:"business_role",isLoading:!1,required:!0,selectedValue:null===t||void 0===t?void 0:t.business_role,requiredError:"This field is required",defaultValue:T.find((function(e){return(null===t||void 0===t?void 0:t.business_role)===e.value})),value:T.find((function(e){return(null===t||void 0===t?void 0:t.business_role)===e.value}))})),r.a.createElement(h.a,{xs:12},r.a.createElement(g.a,{label:"Enter first name of contact person",onBlur:function(){return function(){var e,n,a,r;P.full_name&&((null===(e=t.contact_person_name)||void 0===e||null===(n=e.toLowerCase())||void 0===n?void 0:n.split(/\s/g)[0])===(null===P||void 0===P||null===(a=P.full_name)||void 0===a||null===(r=a.toLowerCase())||void 0===r?void 0:r.split(/\s/g)[0])?(I(!0),V(""),d((function(e){return Object(c.a)(Object(c.a)({},e),{},{contact_person_name:P.full_name})}))):V("Id Number and First Name provided do not match. Please try again."))}()},required:!0,disabled:L,type:"text",className:"form-control pl-5 m-0",name:"contact_person_name",id:"contact_person_name",value:null===t||void 0===t?void 0:t.contact_person_name,onChange:n,placeholder:"Enter contact person name",helpText:R&&r.a.createElement("div",{style:{color:"red",height:16}},R),style:{borderColor:R&&"red"},validate:{required:{value:!0,errorMessage:"Enter contact person name"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,{xs:6},r.a.createElement(g.a,{label:"Contact Person Email",type:"email",className:"form-control pl-5 m-0",name:"contact_person_email",value:null===t||void 0===t?void 0:t.contact_person_email,id:"contact_person_email",errorMessage:"Please enter a valid email address",onChange:n,placeholder:"Enter email address",required:!0,validate:{required:{value:!0,errorMessage:"Please enter email address"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,{xs:6},r.a.createElement(g.a,{label:"Enter contact person phone number",required:!0,type:"text",className:"form-control pl-5 m-0",name:"contact_person_phone",id:"contact_person_phone",value:null===t||void 0===t?void 0:t.contact_person_phone,onChange:n,placeholder:"Enter phone number",validate:{required:{value:!0,errorMessage:"Please enter mobile number"},pattern:{value:x.d,errorMessage:x.e}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,null,r.a.createElement("div",{style:{height:120}})))},P=n(3),q=n(1319),k=n(54),L=function(e){var t=e.label,n=e.value,a=Object(p.d)();return r.a.createElement(q.a,{item:!0,xs:12,sm:6},r.a.createElement(w.a,{className:a.label},t),r.a.createElement(w.a,{className:a.value},n||"_"))},I=function(e){var t,n,o,i=e.values,l=e.onValidChange,u=e.onApplicationFeeChange,d=r.a.useState("panel1"),b=Object(s.a)(d,2),m=b[0],v=b[1],h=function(e){return function(t,n){v(!!n&&e)}},g=Object(c.a)(Object(c.a)({},JSON.parse(localStorage.getItem("drafts")||"{}")[i.id]),i),y=g.email,O=g.subsidiary_name,E=g.phone_number,j=g.business_name,S=g.buss_description,C=g.tier_code,x=g.business_category,N=g.quantity,P=g.buss_sub_category,I=g.floor_no,B=g.room_stall,A=g.plot_bulding_name,R=g.plot_no,V=g.addition_activity,z=g.contact_person_email,T=g.contact_person_phone,M=g.address,D=g.postal_code,U=g.area_meters_square,F=g.id,J=g.town,W=g.sub_county,K=g.ward,G=g.contact_person_name,Q=g.pobox,$=g.contact_person_id,H=g.payment_plan,Y=Object(p.d)(),Z=Object(a.useCallback)(l,[]),X=Object(a.useState)([]),ee=Object(s.a)(X,2),te=ee[0],ne=ee[1],ae=Object(f.useDispatch)(),re=Object(f.useSelector)((function(e){return e.singleBusinessPermit.businessCategory.response})),oe=Object(f.useSelector)((function(e){return e.singleBusinessPermit.businessSubCategory.response})),ie=Object(f.useSelector)((function(e){var t;return null===(t=e.singleBusinessPermit.sbpApplication.errors)||void 0===t?void 0:t.description}));Object(a.useEffect)((function(){Object(_.i)("subcounties","",(function(e){ae(Object(_.q)(e.subcountyres))}),console.error).then(),Object(_.i)("wards","",(function(e){ae(Object(_.r)(e.wardres))}),console.error).then()}),[ae]);var le=Object(f.useSelector)((function(e){return e.global.subCounties})),ce=Object(f.useSelector)((function(e){return e.global.wards}));Object(a.useEffect)((function(){Object(_.f)({code:g.business_category},ae).then(),Object(_.d)(ae).then()}),[x,g.business_category,ae]);var se=le.find((function(e){return e.code===W})),ue=ce.find((function(e){return e.code===g.ward})),de=(re||[]).find((function(e){return x===e.bus_code})),be=(oe||[]).find((function(e){return P===e.bus_code}));Object(a.useEffect)((function(){Z(T&&j&&S&&P&&x)}),[Z,M,T,j,S,P,x]),Object(a.useEffect)((function(){if(P&&P){Object(_.e)(i.buss_sub_category,(function(e){ne(e.businessSize)}),console.log).then()}}),[P]);var me=Object(a.useState)("0000"),pe=Object(s.a)(me,2),ve=pe[0],fe=pe[1];Object(a.useEffect)((function(){Object(_.g)({category:x,sub_category:P,category_tier:"".concat(C),quantity:N||1},(function(e){u(e),fe(e)}),console.log)}),[]);var he=null===te||void 0===te||null===(t=te.find((function(e){return"".concat(e.tier_code)==="".concat(C)})))||void 0===t?void 0:t.employee_range;return r.a.createElement("div",null,ie&&r.a.createElement("div",{style:{background:"red",padding:8,borderRadius:8,position:"relative"}},r.a.createElement(w.a,{style:{color:"#fff",fontSize:12}},ie)),r.a.createElement(p.a,{square:!0,expanded:"panel1"===m,onChange:h("panel1")},r.a.createElement(p.c,{"aria-controls":"panel1d-content",id:"panel1d-header"},r.a.createElement(w.a,{color:"primary",style:{fontSize:16,fontWeight:"bold"}},"1. Business Category"),r.a.createElement("i",{style:{fontSize:20},className:"mdi mdi-chevron-".concat("panel1"===m?"up":"down")})),r.a.createElement(p.b,null,r.a.createElement(q.a,{className:Y.border,style:{position:"relative"},container:!0,spacing:3},r.a.createElement(L,{label:"Business Category",value:null===de||void 0===de?void 0:de.bus_description}),r.a.createElement(L,{label:"Business Sub Category",value:null===be||void 0===be?void 0:be.bus_description})))),r.a.createElement(p.a,{square:!0,expanded:"panel2"===m,onChange:h("panel2")},r.a.createElement(p.c,{"aria-controls":"panel2d-content",id:"panel2d-header"},r.a.createElement(w.a,{color:"primary",style:{fontSize:16,fontWeight:"bold"}},"2. Business Details"),r.a.createElement("i",{style:{fontSize:20},className:"mdi mdi-chevron-".concat("panel2"===m?"up":"down")})),r.a.createElement(p.b,null,r.a.createElement(q.a,{className:Y.border,style:{position:"relative"},container:!0,spacing:3},r.a.createElement(k.b,{style:{color:"inherit"},to:"/sbp/apply?draftId=".concat(F,"&activeStep=",1)},r.a.createElement("div",{className:Y.edit},r.a.createElement("i",{className:"mdi mdi-pencil icons"}))),r.a.createElement(L,{label:"Business Name",value:j}),r.a.createElement(L,{label:"Subsidiary Name",value:O}),r.a.createElement(L,{label:"Physical address",value:M}),r.a.createElement(L,{label:"Sub County",value:(null===se||void 0===se?void 0:se.description)||W}),r.a.createElement(L,{label:"Ward",value:(null===ue||void 0===ue?void 0:ue.description)||K}),r.a.createElement(L,{label:"Plot/LR number",value:R}),r.a.createElement(L,{label:"Building name",value:A}),r.a.createElement(L,{label:"Floor number",value:I}),r.a.createElement(L,{label:"Room stall number",value:B})))),r.a.createElement(p.a,{square:!0,expanded:"panel3"===m,onChange:h("panel3")},r.a.createElement(p.c,{"aria-controls":"panel3d-content",id:"panel3d-header"},r.a.createElement(w.a,{color:"primary",style:{fontSize:16,fontWeight:"bold"}},"3. Business Activity Information"),r.a.createElement("i",{style:{fontSize:20},className:"mdi mdi-chevron-".concat("panel3"===m?"up":"down")})),r.a.createElement(p.b,null,r.a.createElement(q.a,{className:Y.border,style:{position:"relative"},container:!0,spacing:3},r.a.createElement(k.b,{style:{color:"inherit"},to:"/sbp/apply?draftId=".concat(F,"&activeStep=",2)},r.a.createElement("div",{className:Y.edit},r.a.createElement("i",{className:"mdi mdi-pencil icons"}))),r.a.createElement(L,{label:"Business Description",value:S}),r.a.createElement(L,{label:"Number of employees",value:he}),r.a.createElement(L,{label:"Payment Plan",value:H}),r.a.createElement(L,{label:"Area in square metres",value:U}),r.a.createElement(L,{label:"Additional activity",value:V})))),r.a.createElement(p.a,{square:!0,expanded:"panel4"===m,onChange:h("panel4")},r.a.createElement(p.c,{"aria-controls":"panel4d-content",id:"panel4d-header"},r.a.createElement(w.a,{color:"primary",style:{fontSize:16,fontWeight:"bold"}},"4. Business Contacts"),r.a.createElement("i",{style:{fontSize:20},className:"mdi mdi-chevron-".concat("panel4"===m?"up":"down")})),r.a.createElement(p.b,null,r.a.createElement(q.a,{className:Y.border,style:{position:"relative"},container:!0,spacing:3},r.a.createElement(k.b,{style:{color:"inherit"},to:"/sbp/apply?draftId=".concat(F,"&activeStep=",3)},r.a.createElement("div",{className:Y.edit},r.a.createElement("i",{className:"mdi mdi-pencil icons"}))),y&&r.a.createElement(L,{label:"Email",value:y}),E&&r.a.createElement(L,{label:"Phone Number",value:E}),r.a.createElement(L,{label:"P.O Box",value:Q}),r.a.createElement(L,{label:"Town",value:J}),r.a.createElement(L,{label:"Postal Code",value:D}),r.a.createElement(L,{label:"Contact Person ID/Passport/KRA PIN",value:$}),r.a.createElement(L,{label:"Contact Person Name",value:G}),r.a.createElement(L,{label:"Contact Person Email address",value:z}),r.a.createElement(L,{label:"Contact Person Phone Number",value:T})))),r.a.createElement("div",{className:Y.banner},r.a.createElement(w.a,null,"The Business Permit Fee for this application is ",r.a.createElement("strong",null,"KES ",Number(null===ve||void 0===ve||null===(n=ve.Amount)||void 0===n?void 0:n.replace(/,/g,""))-200>0?Number(null===ve||void 0===ve||null===(o=ve.Amount)||void 0===o?void 0:o.replace(/,/g,""))-200:null===ve||void 0===ve?void 0:ve.Amount)," subject to inspection and approval. Please pay an application fee of ",r.a.createElement("strong",null,"KES ",200)," for your application to be considered.")))},B=function(e){var t=e.onChange,n=e.onSelectChange,o=e.values,i=e.onValidChange,l=e.setValues,u=Object(a.useState)([]),d=Object(s.a)(u,2),b=d[0],m=d[1],p=Object(a.useState)([]),y=Object(s.a)(p,2),O=(y[0],y[1]),j=JSON.parse(localStorage.getItem("drafts"));j.greyOut=!1;var S=Object(f.useSelector)((function(e){var t=e.singleBusinessPermit;return Object(c.a)({},t)})),C=S.businessCategory,w=C.response,x=C.loading,N=S.businessSubCategory,P=N.response,q=N.loading,k=Object(a.useCallback)(i,[]);Object(a.useEffect)((function(){var e=o.business_category,t=o.buss_sub_category,n=o.buss_description,a=o.area_meters_square,r=o.payment_plan,i=o.tier_code;k(!!(e&&t&&n&&a&&r&&i))}),[k,o]),Object(a.useEffect)((function(){if(o.buss_sub_category){Object(_.e)(o.buss_sub_category,(function(e){m(e.businessSize)}),console.log).then()}}),[]),Object(a.useEffect)((function(){Object(_.h)((function(e){O(e||[])}),console.log).then()}),[]);var L=(P||[]).map((function(e){return{value:null===e||void 0===e?void 0:e.bus_code,label:"".concat(null===e||void 0===e?void 0:e.bus_description," - ").concat(null===e||void 0===e?void 0:e.bus_code),key:null===e||void 0===e?void 0:e.bus_code,id:"buss_sub_category"}})),I=(w||[]).map((function(e){return{value:null===e||void 0===e?void 0:e.bus_code,label:r.a.createElement("div",{style:{borderBottom:"1px solid lightgray"}},r.a.createElement("div",{style:{fontWeight:"bold",fontSize:16}},null===e||void 0===e?void 0:e.bus_description," - ",null===e||void 0===e?void 0:e.bus_code),r.a.createElement("div",{style:{fontSize:10}},(null===e||void 0===e?void 0:e.finance_act_desc)||"No Description")),key:null===e||void 0===e?void 0:e.bus_code,id:"business_category"}})),B=b.map((function(e){return{value:e.tier_code,label:"".concat(e.employee_range),key:e.tier_code,id:"tier_code"}})),A=r.a.createElement(v.a,{handleSelectChange:n,options:I,placeholder:(null===o||void 0===o?void 0:o.buss_category_name)||"Select business category",label:"Select business category",labelId:"business_category",isLoading:x,selectedValue:null===o||void 0===o?void 0:o.business_category,value:I.find((function(e){return(null===o||void 0===o?void 0:o.business_category)===e.value})),isDisabled:null===j||void 0===j?void 0:j.greyOut,required:!0,requiredError:"Please select business category"}),R=r.a.createElement(v.a,{handleSelectChange:function(e){l((function(e){return Object(c.a)(Object(c.a)({},e),{},{tier_code:""})})),Object(_.e)(e.value,(function(e){m(e.businessSize)}),console.log).then(),n(e)},options:L,placeholder:(null===o||void 0===o?void 0:o.sub_category_name)||"Select business sub category",label:"Select business sub category",labelId:"buss_sub_category",isLoading:q,selectedValue:null===o||void 0===o?void 0:o.buss_sub_category,requiredError:"Please select business category",defaultValue:L.find((function(e){return(null===o||void 0===o?void 0:o.buss_sub_category)===e.value})),value:L.find((function(e){return(null===o||void 0===o?void 0:o.buss_sub_category)===e.value})),isDisabled:!L.length||(null===j||void 0===j?void 0:j.greyOut),required:!0});return r.a.createElement(E.a,null,r.a.createElement(h.a,null,A),r.a.createElement(h.a,null,R),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(h.a,null,r.a.createElement(g.a,{labelFor:"buss_description",label:"Business description",onChange:t,required:!0,type:"textarea",className:"form-control pl-5",name:"buss_description",value:null===o||void 0===o?void 0:o.buss_description,id:"buss_description",placeholder:"Enter business description",maxLength:"200",disabled:null===j||void 0===j?void 0:j.greyOut,style:(null===j||void 0===j?void 0:j.greyOut)?{resize:"none",background:"#eee"}:{resize:"none"},validate:{required:{value:!0,errorMessage:"Please enter business description"}}},r.a.createElement("i",{className:"mdi mdi-message-text-outline ml-3 icons"})))),(null===o||void 0===o?void 0:o.QuantityRequired)&&r.a.createElement(h.a,{xs:12,sm:6},r.a.createElement(g.a,{label:null===o||void 0===o?void 0:o.QuantityCaption,className:"form-control pl-5 m-0",name:"quantity",id:"quantity",value:null===o||void 0===o?void 0:o.quantity,onChange:t,placeholder:null===o||void 0===o?void 0:o.QuantityCaption,validate:{required:{value:!0,errorMessage:"Please enter area in ".concat(null===o||void 0===o?void 0:o.QuantityCaption)}}})),r.a.createElement(h.a,{xs:12,sm:6},r.a.createElement(v.a,{handleSelectChange:n,options:B,placeholder:(null===o||void 0===o?void 0:o.tier_code)||"Number of employees",label:"Number of employees",labelId:"tier_code",selectedValue:null===o||void 0===o?void 0:o.tier_code,requiredError:"Please select employee size",defaultValue:B.find((function(e){return(null===o||void 0===o?void 0:o.tier_code)===e.value})),value:null===o||void 0===o?void 0:o.tier_code,isDisabled:!B.length||(null===j||void 0===j?void 0:j.greyOut),required:!0})),r.a.createElement(h.a,{xs:12},r.a.createElement(g.a,{label:"Addition Activity if any (Optional)",className:"form-control pl-5 m-0",name:"addition_activity",id:"addition_activity",value:null===o||void 0===o?void 0:o.addition_activity,onChange:t,placeholder:"Additional Activity",validate:{required:{value:!0,errorMessage:"Please enter area in square metres e.g 4840.44"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))),r.a.createElement(h.a,{xs:12},r.a.createElement(g.a,{label:"Premises Size (Area) in Sq. Meters",required:!0,className:"form-control pl-5 m-0",name:"area_meters_square",id:"area_meters_square",value:null===o||void 0===o?void 0:o.area_meters_square,onChange:t,placeholder:"Premises Size (Area) in Sq. Meters",validate:{required:{value:!0,errorMessage:"Please enter area in square metres e.g 4840.44"},pattern:{value:"^[0-9]+.?[0-9]*$",errorMessage:"Area in square metres must be decimal e.g 4840.44"}}},r.a.createElement("i",{className:"mdi mdi-briefcase ml-3 icons"}))))},A=["id"];function R(){R=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(N){c=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),l=new C(r||[]);return a(i,"_invoke",{value:O(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(N){return{type:"throw",arg:N}}}e.wrap=s;var d={};function b(){}function m(){}function p(){}var v={};c(v,o,(function(){return this}));var f=Object.getPrototypeOf,h=f&&f(f(w([])));h&&h!==t&&n.call(h,o)&&(v=h);var g=p.prototype=b.prototype=Object.create(v);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){var r;a(this,"_invoke",{value:function(a,o){function i(){return new t((function(r,i){!function a(r,o,i,l){var c=u(e[r],e,o);if("throw"!==c.type){var s=c.arg,d=s.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(d).then((function(e){s.value=e,i(s)}),(function(e){return a("throw",e,i,l)}))}l(c.arg)}(a,o,r,i)}))}return r=r?r.then(i,i):i()}})}function O(e,t,n){var a="suspendedStart";return function(r,o){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===r)throw o;return x()}for(n.method=r,n.arg=o;;){var i=n.delegate;if(i){var l=E(i,n);if(l){if(l===d)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===a)throw a="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a="executing";var c=u(e,t,n);if("normal"===c.type){if(a=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,a=e.iterator[n];if(void 0===a)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var r=u(a,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function w(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function t(){for(;++a<e.length;)if(n.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:x}}function x(){return{value:void 0,done:!0}}return m.prototype=p,a(g,"constructor",{value:p,configurable:!0}),a(p,"constructor",{value:m,configurable:!0}),m.displayName=c(p,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},y(_.prototype),c(_.prototype,i,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,a,r,o){void 0===o&&(o=Promise);var i=new _(s(t,n,a,r),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(g),c(g,l,"Generator"),c(g,o,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var a in t)n.push(a);return n.reverse(),function e(){for(;n.length;){var a=n.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},e.values=w,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(n,a){return i.type="throw",i.arg=e,t.next=n,a&&(t.method="next",t.arg=void 0),!!a}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var r=a.arg;S(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:w(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}var V=function(){var e=Object(p.d)(),t=Object(a.useState)({4:!0}),n=Object(s.a)(t,2),v=n[0],h=n[1],g=JSON.parse(localStorage.getItem("drafts")||"{}"),y=Object(f.useDispatch)(),E=Object(a.useCallback)(y,[]),j=Object(S.g)(),w=Object(S.h)().search,x=new URLSearchParams(w).get("draftId"),q=new URLSearchParams(w).get("activeStep"),k=new URLSearchParams(w).get("brsNumber"),L=new URLSearchParams(w).get("kraPin"),V=Object(a.useState)((function(){return parseInt(q,10)<5?parseInt(q,10):0})),z=Object(s.a)(V,2),T=z[0],M=z[1],D=Object(a.useState)(!1),U=Object(s.a)(D,2),F=U[0],J=U[1],W=Object(a.useState)((function(){return Object(c.a)({kraPin:(null===L||void 0===L?void 0:L.toUpperCase())||""},g[x])})),K=Object(s.a)(W,2),G=K[0],Q=K[1],$=Object(a.useCallback)(Object(u.a)(_.b,1e3),[]),H=!!k||!!L;Object(a.useEffect)((function(){var e=ee.filter((function(e){return(null===e||void 0===e?void 0:e.bus_code)===(null===G||void 0===G?void 0:G.buss_sub_category)}))[0];Q((function(t){return Object(c.a)(Object(c.a)({},t),{},{QuantityRequired:"Yes"===(null===e||void 0===e?void 0:e.Quantity_Required),QuantityCaption:null===e||void 0===e?void 0:e.Quantity_Caption})}))}),[null===G||void 0===G?void 0:G.buss_sub_category]),Object(a.useEffect)((function(){(null===G||void 0===G?void 0:G.contact_person_id)&&(Q((function(e){return Object(c.a)(Object(c.a)({},e),{},{contact_person_id:null===G||void 0===G?void 0:G.contact_person_id,phone_number:"",email:""})})),Object(_.j)(null===G||void 0===G?void 0:G.contact_person_id,y).then()),H&&Q((function(e){return Object(c.a)(Object(c.a)({},e),{},{registered:H})}))}),[null===G||void 0===G?void 0:G.contact_person_id,H]);var Y=Object(f.useSelector)((function(e){return Object(c.a)(Object(c.a)({},e.singleBusinessPermit),{},{activeUser:e.profile.activeUser})})),Z=Y.businessDetails.response.records,X=void 0===Z?[]:Z,ee=Y.businessSubCategory.response,te=Y.sbpApplication.loading,ne=Y.draftApplications.response,ae=Y.activeUser,re=X[0],oe=ae.business_name,ie=Object(f.useSelector)((function(e){var t,n;return null===(t=e.profile)||void 0===t||null===(n=t.activeUser)||void 0===n?void 0:n.id_number}));Object(a.useEffect)((function(){Q((function(e){return Object(c.a)(Object(c.a)(Object(c.a)({},e),re),{},{address:null===re||void 0===re?void 0:re.physical_address,contact_person_id:ie||e.contact_person_id})}))}),[re,ie]);var le=Object(f.useSelector)((function(e){var t,n;return null===(t=e.profile)||void 0===t||null===(n=t.activeUser)||void 0===n?void 0:n.pin_no}));Object(a.useEffect)((function(){le&&Q((function(e){return Object(c.a)(Object(c.a)({},e),{},{kraPin:le})}))}),[le]);var ce=function(){var e=Object(l.a)(R().mark((function e(t){var n,a;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Q((function(e){return Object(c.a)(Object(c.a)({},e),{},Object(i.a)({},t.target.id,t.target.value))})),n=Object(c.a)(Object(c.a)({},G),{},Object(i.a)({},t.target.id,t.target.value)),a=function(e){n.id||Q((function(t){return Object(c.a)(Object(c.a)({},t),{},{id:e.id})}));var t=function(){return JSON.parse(localStorage.getItem("drafts")||"{}")};localStorage.setItem("drafts",JSON.stringify(Object(c.a)(Object(c.a)({},t()),{},Object(i.a)({},e.id,Object(c.a)(Object(c.a)(Object(c.a)({},t()[e.id]),G),{},{brs_no:k})))))},!te&&T&&"kraPin"!==t.target.id&&$(n,y,a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){G.business_category&&Object(_.f)({code:G.business_category},E).then()}),[]);var se=function(){var e=Object(l.a)(R().mark((function e(t){var n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Q((function(e){return Object(c.a)(Object(c.a)({},e),{},Object(i.a)({},t.id,t.value))})),"business_category"===t.id&&(Object(_.f)({code:t.value},E).then(),Q((function(e){return Object(c.a)(Object(c.a)({},e),{},{buss_sub_category:""})}))),"sub_county"!==t.id){e.next=7;break}return n=function(e){y(Object(_.r)(e.wardres))},Q((function(e){return Object(c.a)(Object(c.a)({},e),{},{ward:""})})),e.next=7,Object(_.i)("wards","/".concat(t.value),n,console.error);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=Object(a.useState)({message:""}),de=Object(s.a)(ue,2),be=de[0],me=de[1],pe=Object(a.useState)("0"),ve=Object(s.a)(pe,2),fe=ve[0],he=ve[1],ge=[{label:"Business Category",component:r.a.createElement(O,{values:G,setValues:Q,error:be,onChange:ce,onSelectChange:se,useKra:F,setUseKra:J,onValidChange:function(e){return h((function(t){return Object(c.a)(Object(c.a)({},t),{},{0:e})}))}})},{label:"Business Details",component:r.a.createElement(C,{onChange:ce,onSelectChange:se,onValidChange:function(e){return h((function(t){return Object(c.a)(Object(c.a)({},t),{},{1:e})}))},values:G,setValues:Q})},{label:"Business Activity Information",component:r.a.createElement(B,{onValidChange:function(e){return h((function(t){return Object(c.a)(Object(c.a)({},t),{},{2:e})}))},values:G,onChange:ce,onSelectChange:se,setValues:Q})},{label:"Business Contacts",component:r.a.createElement(N,{onChange:ce,onSelectChange:se,onValidChange:function(e){return h((function(t){return Object(c.a)(Object(c.a)({},t),{},{3:e})}))},values:G,setValues:Q})},{label:"Review and Submit",component:r.a.createElement(I,{values:G,onValidChange:function(e){return h((function(t){return Object(c.a)(Object(c.a)({},t),{},{4:e})}))},onApplicationFeeChange:function(e){he(null===e||void 0===e?void 0:e.ApplicationFee)}})}],ye=Object(f.useSelector)((function(e){var t;return null===(t=e.singleBusinessPermit.sbpApplication.response)||void 0===t?void 0:t.amount})),_e=Object(f.useSelector)((function(e){var t;return null===(t=e.singleBusinessPermit.sbpApplication.response)||void 0===t?void 0:t.invoice_no}));Object(a.useEffect)((function(){ye&&_e&&j.push({pathname:"/sbp/payments",state:{mpesaSuccessModal:"sbp",invoice:void 0,total:void 0}})}),[ye,_e,j]);var Oe=function(){var e=Object(l.a)(R().mark((function e(){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(G,y,(function(){parseInt(fe,10)||j.push("/account/bills")}),!0);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){Object(_.d)(E).then()}),[E]),Object(a.useEffect)((function(){if(oe){ae.id;var e=Object(o.a)(ae,A);y({type:P.hc,payload:{records:[e]}})}}),[oe,ae,y]);var Ee=ne.find((function(e){var t=e.id;return"".concat(t)===x}));Object(a.useEffect)((function(){Ee&&Q((function(e){return Object(c.a)(Object(c.a)({},e),Ee)}))}),[Ee]);var je=function(){var e=Object(l.a)(R().mark((function e(){var t;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=function(e){M(T+1);var t=function(){return JSON.parse(localStorage.getItem("drafts")||"{}")};localStorage.setItem("drafts",JSON.stringify(Object(c.a)(Object(c.a)({},t()),{},Object(i.a)({},e.id,Object(c.a)(Object(c.a)({},t()[e.id]),G))))),(x||e)&&j.push("?draftId=".concat(x||e.id,"&activeStep=").concat(T+1))},0!==T){e.next=12;break}if(!G.kraPin||!F){e.next=5;break}return j.push("?activeStep=".concat(T+1,"&kraPin=").concat(G.kraPin)),e.abrupt("return");case 5:if(!G.brsNumber||F){e.next=11;break}return e.next=8,Object(_.k)({brs_no:(G.brsNumber||"").trim()},y,(function(e){if(!e.count)return me({message:"No business records matches your input"});j.push("?activeStep=".concat(T+1,"&brsNumber=").concat(G.brsNumber))}));case 8:return e.abrupt("return",e.sent);case 11:j.replace("?activeStep=".concat(T+1),Object(c.a)({},G));case 12:return e.next=14,Object(_.b)(G,E,t);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){me({message:""})}),[G.brsNumber]),Object(a.useEffect)((function(){Object(_.m)(E).then()}),[E]),r.a.createElement("div",{className:"root"},r.a.createElement(d.a,{className:[e.box,"shadow"].join(" ")},r.a.createElement(b.a,{className:e.header},"Single Business Permit Application"),r.a.createElement(m.a,{previousButtonProps:{disabled:oe&&1===T},onClickBack:function(){return M((function(e){return e-1}))},nextButtonProps:{type:"submit",disabled:"3"===T.toString()&&!v["".concat(T)],loading:T===ge.length-1&&te},isLoading:te,onClickForward:function(){return je()},onFinish:Oe,activeStep:T,steps:ge})))};t.default=function(e){return r.a.createElement("div",{style:{minHeight:"calc(100vh - 332px)",display:"flex",width:"100vw",alignItems:"center",justifyContent:"center",backgroundSize:"100% 30%"},className:"auth-page_wrapper"},r.a.createElement("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",minHeight:700}},r.a.createElement(V,null)))}},633:function(e,t,n){"use strict";var a=n(0),r=n(89),o=n(1),i=n.n(o),l=n(656),c=n(111),s=n(81),u=n(655),d=n(636),b=n.n(d),m=["handleSelectChange","multiple","options","placeholder","label","labelId","selectedValue","required","requiredError","isCreatableSelect","isReserved"];t.a=function(e){var t=e.handleSelectChange,n=e.multiple,o=e.options,d=e.placeholder,p=e.label,v=e.labelId,f=e.selectedValue,h=e.required,g=e.requiredError,y=e.isCreatableSelect,_=e.isReserved,O=Object(r.a)(e,m),E={control:function(e){return Object(a.a)(Object(a.a)({},e),{},{border:"none",boxShadow:"none","&:hover":{border:"none"},"&:active":{border:"none"}})},menu:function(e){return Object(a.a)(Object(a.a)({},e),{},{zIndex:1e3})}};return i.a.createElement(i.a.Fragment,null,p&&i.a.createElement(c.a,{for:v,className:b.a.selectLabels},p),_?i.a.createElement(l.a,Object.assign({onChange:t,options:o,isMulti:n,hideSelectedOptions:!0,placeholder:d,className:b.a.selectComponent,styles:E,theme:function(e){return Object(a.a)(Object(a.a)({},e),{},{colors:Object(a.a)(Object(a.a)({},e.colors),{},{primary25:"#bfdbc7",primary50:"#99c9a7",primary:"#0a4e1d"})})},value:null===o||void 0===o?void 0:o.filter((function(e){return e.value===f}))},O)):y?i.a.createElement(u.a,Object.assign({onChange:t,options:o,hideSelectedOptions:!0,placeholder:d,className:b.a.selectComponent,styles:E,theme:function(e){return Object(a.a)(Object(a.a)({},e),{},{colors:Object(a.a)(Object(a.a)({},e.colors),{},{primary25:"#bfdbc7",primary50:"#99c9a7",primary:"#0a4e1d"})})}},O)):i.a.createElement(l.a,Object.assign({onChange:t,options:o,isMulti:n,hideSelectedOptions:!0,placeholder:d,className:b.a.selectComponent,styles:E,theme:function(e){return Object(a.a)(Object(a.a)({},e),{},{colors:Object(a.a)(Object(a.a)({},e.colors),{},{primary25:"#bfdbc7",primary50:"#99c9a7",primary:"#0a4e1d"})})}},O)),i.a.createElement(s.a,{required:h,type:"text",className:"form-control pl-5 m-0 d-none",name:v,onChange:t,id:v,value:f,placeholder:d,validate:{required:{value:!0,errorMessage:g}}}))}},636:function(e,t,n){e.exports={selectLabels:"Select_selectLabels__35RFL",selectComponent:"Select_selectComponent__37pHe",expiry:"Select_expiry__37-fk",input:"Select_input__165co"}},692:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(592),r=n(694),o=n(25),i=n(759),l=n(760),c=n(761);t.d=Object(a.a)((function(e){return Object(r.a)({box:{maxWidth:800,width:"100%",overflow:"hidden",borderRadius:0,zIndex:10},banner:{background:"rgba(128,248,81,0.2)",marginTop:16,padding:16,borderRadius:8},header:{height:48,display:"flex",alignItems:"center",borderBottom:"1px solid lightgrey",width:"100%",marginBottom:16,boxSizing:"border-box",fontSize:20,fontWeight:"bold",padding:16,background:"#f8f9fc"},confirmButton:{width:120,borderRadius:16,borderColor:"transparent",textTransform:"none"},label:{fontSize:12,color:e.palette.grey[600]},value:{fontSize:16,color:"#000",overflow:"auto"},border:{},edit:{position:"absolute",top:0,right:0,width:32,height:32,display:"flex",alignItems:"center",borderRadius:4,justifyContent:"center","&:hover":{background:e.palette.grey[100]}}})}));var s=Object(o.a)({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(i.a),u=Object(o.a)({root:{borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:56,"&$expanded":{minHeight:56}},content:{display:"flex",justifyContent:"space-between","&$expanded":{margin:"12px 0"}},expanded:{}})(l.a),d=Object(o.a)((function(e){return{root:{padding:e.spacing(2)}}}))(c.a)},762:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=[{value:"0",label:"New",key:"New",id:"application_type"},{value:"1",label:"Renewal",key:"Renewal",id:"application_type"}]}}]);